(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fc984418"],{"7a97":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"report_manage"},[a("el-select",{attrs:{placeholder:"请选择大棚"},on:{change:e.changeGreenhouseHandler},model:{value:e.greenhouse,callback:function(t){e.greenhouse=t},expression:"greenhouse"}},e._l(e.greenhouseList,(function(e){return a("el-option",{key:e.areaId,attrs:{label:e.areaName,value:e.areaId}})})),1),e._v(" "),a("el-select",{attrs:{placeholder:"请选择传感器"},on:{change:e.changedeviceNameHandler},model:{value:e.sensor,callback:function(t){e.sensor=t},expression:"sensor"}},e._l(e.sensorList,(function(e){return a("el-option",{key:e.deviceId,attrs:{label:e.deviceName,value:e.deviceId}})})),1),e._v(" "),a("el-divider"),e._v(" "),0==this.$route.query.type?a("div",{staticClass:"report-name"},[e._v("企业名称："+e._s(e.companyName)+"———大棚名称："+e._s(e.displayName)+"——传感器名称："+e._s(e.deviceName))]):e._e(),e._v(" "),3==this.$route.query.type?a("div",{staticClass:"report-name"},[e._v("企业名称："+e._s(e.companyName)+"———仓库名称："+e._s(e.displayName)+"——传感器名称："+e._s(e.deviceName))]):e._e(),e._v(" "),a("div",{staticClass:"report-data"},[a("div",{staticClass:"report-date"},[a("div",{class:{active:0==e.strategy},on:{click:function(t){return e.changeData(0)}}},[e._v("实时图")]),e._v(" "),a("div",{class:{active:1==e.strategy},on:{click:function(t){return e.changeData(1)}}},[e._v("最高值")]),e._v(" "),a("div",{class:{active:2==e.strategy},on:{click:function(t){return e.changeData(2)}}},[e._v("最低值")]),e._v(" "),a("div",{class:{active:3==e.strategy},on:{click:function(t){return e.changeData(3)}}},[e._v("平均值")])]),e._v(" "),a("div",{staticClass:"report-time"},[a("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd hh:mm:ss","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.changeTimeHandler},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1),e._v(" "),a("div",{staticClass:"report-export"},[a("el-button",{attrs:{type:"primary"}},[e._v("导出excel")])],1)]),e._v(" "),a("div",{staticClass:"data"},[a("IEcharts",{attrs:{option:e.bar,loading:e.loading}})],1)],1)},n=[],i=(a("608b"),a("75fc")),r=a("6b43"),o=a("844a"),c=a("b775"),l=a("4328"),d=a.n(l);function u(e){return Object(c["a"])({url:"/report/getAllDataList",method:"post",data:d.a.stringify(e)})}function h(e){return Object(c["a"])({url:"/report/getAreaList",method:"post",data:d.a.stringify(e)})}function g(e){return Object(c["a"])({url:"/report/getReportDeviceList",method:"post",data:d.a.stringify(e)})}var m={components:{IEcharts:o["a"]},data:function(){return{loading:!1,greenhouse:this.$route.query.areaId,sensor:this.$route.query.id,greenhouseList:[],sensorList:[],displayName:this.$route.query.displayName,deviceName:this.$route.query.deviceName,strategy:0,time:["2018-08-19 08:00:08","2019-09-04 08:00:08"],bar:{title:{text:"报表数据"},tooltip:{},xAxis:{data:[]},yAxis:{},series:{name:"Sales",type:"bar",data:[]}}}},computed:{companyId:function(){return r["a"].getItem("companyId")},companyName:function(){return r["a"].getItem("companyName")}},created:function(){var e=this,t=(this.$route.query,{companyId:this.companyId,type:this.$route.query.type});h(t).then((function(t){1===t.statusCode?(e.greenhouseList.lenght=0,e.greenhouseList=Object(i["a"])(t.result),e.getReportDeviceList(),e.getAllDataList()):e.$message({message:t.message,type:"warning"})}))},methods:{getReportDeviceList:function(){var e=this,t=this.$loading({lock:!0,text:"正在加载...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),a=(this.$route.query,{companyId:this.companyId,areaId:this.greenhouse});g(a).then((function(a){1===a.statusCode?(e.sensorList.length=0,e.sensorList=Object(i["a"])(a.result),e.sensorList.length>0&&(e.sensor=e.sensorList[0].deviceId),e.getAllDataList(),t.close()):e.$message({message:a.message,type:"warning"})}))},changeGreenhouseHandler:function(e){var t=this.greenhouseList.find((function(t){return t.areaId==e}));this.displayName=t.areaName,this.sensor="",this.getReportDeviceList()},changedeviceNameHandler:function(e){var t=this.sensorList.find((function(t){return t.deviceId==e}));this.deviceName=t.deviceName,this.getAllDataList()},getAllDataList:function(){var e=this,t=this.$loading({lock:!0,text:"正在加载数据...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),a={companyId:this.companyId,areaId:this.greenhouse,deviceId:this.sensor,strategy:this.strategy,startTime:this.time[0],endTime:this.time[1]};u(a).then((function(a){e.bar.xAxis.data.length=0,e.bar.series.data.lenght=0,e.bar.xAxis.data=Object(i["a"])(a.result.x),e.bar.series.data=a.result.y,t.close()}))},changeData:function(e){this.strategy=e,this.getAllDataList()},changeTimeHandler:function(){this.getAllDataList()}}},p=m,v=(a("9db0"),a("2877")),y=Object(v["a"])(p,s,n,!1,null,"60db9eb7",null);t["default"]=y.exports},"9db0":function(e,t,a){"use strict";var s=a("c472"),n=a.n(s);n.a},c472:function(e,t,a){}}]);